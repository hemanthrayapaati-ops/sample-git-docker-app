steps:
  build_and_push:
    image: docker:24.0
    environment:
      DOCKER_HOST: tcp://host.docker.internal:2375
    secrets:
      - DOCKER_USERNAME
      - DOCKER_PASSWORD
    commands:
      - echo "ğŸš€ Building Docker image..."
      - docker build -t hemanthr2002/sample-app:${CI_COMMIT_SHA:0:7} .
      - echo "ğŸ” Logging into Docker Hub..."
      - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
      - echo "ğŸ“¤ Pushing image to Docker Hub..."
      - docker push hemanthr2002/sample-app:${CI_COMMIT_SHA:0:7}
      - docker tag hemanthr2002/sample-app:${CI_COMMIT_SHA:0:7} hemanthr2002/sample-app:latest
      - docker push hemanthr2002/sample-app:latest
